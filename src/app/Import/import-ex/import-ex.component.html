<!-- Table with user interaction And Export Functionality -->
<div class="container my-5">
  <!-- Toolbar for File Selection, Search, and Sorting -->
  <div class="toolbar">
    <div class="upload-section">
      <label for="fileInput">Upload File:</label>
      <input
        type="file"
        id="fileInput"
        (change)="csvImport($event)"
        accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
        multiple
        class="form-control-file"
      >
    </div>

    <div class="file-select-section">
      <label for="fileSelect">Select File:</label>
      <select id="fileSelect" (change)="onFileSelect($event)" class="form-control">
        <option *ngFor="let file of files" [value]="file.name">{{ file.name }}</option>
      </select>
    </div>

    <div class="sheet-select-section">
      <label for="sheetSelect">Select Sheet:</label>
      <select id="sheetSelect" (change)="onSheetSelect($event)" class="form-control">
        <option *ngFor="let sheet of selectedFile?.sheets" [value]="sheet">{{ sheet }}</option>
      </select>
    </div>

    <div class="sorting-options">
      <label for="sortColumn">Sort Column:</label>
      <select id="sortColumn" (change)="onSortColumnChange($event)" class="form-control">
        <option *ngFor="let header of getHeaders()" [value]="header">{{ header }}</option>
      </select>

      <label for="sortDirection">Sort Direction:</label>
      <select id="sortDirection" (change)="onSortDirectionChange($event)" class="form-control">
        <option value="asc">Ascending</option>
        <option value="desc">Descending</option>
      </select>
    </div>

    <div class="search-section">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        placeholder="Search..." 
        class="form-control"
      >
    </div>

    <div class="export-section">
      <button (click)="exportToExcel()" class="btn btn-primary">Export to Excel</button>
    </div>
  </div>

  <!-- Table with Sorting Functionality And User Input With type text --> 
  <div *ngIf="selectedData.length > 0" class="table-section">
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th *ngFor="let header of getHeaders()">{{ header }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of filteredData; let rowIndex = index">
          <td *ngFor="let header of getHeaders()">
            <input type="text"  [value]="row[header] || ''"  (input)="onCellEdit(rowIndex, header, $event)"  class="form-control"> 
            <!-- When the user types, the input event is triggered.The onCellEdit(rowIndex, header, event) method is called. -->
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
